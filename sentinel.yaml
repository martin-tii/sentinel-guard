# Authorization policy source of truth:
# policies/rego/sentinel/authz.rego

blocked_keywords:
  - "ignore previous instructions"

policy_integrity:
  tamper_detection: true

judge:
  enabled: true
  provider: "ollama"
  model: "llama-guard3"
  endpoint: "http://localhost:11434/api/generate"
  runtime_judge_threshold: 0.4
  risk_threshold: 0.7
  prompt_guard:
    enabled: true
    model: "meta-llama/Llama-Prompt-Guard-2-86M"
    threshold: 0.8
    fail_open: false
  injection_scan:
    enabled: true
    on_detection: "approval"   # block | approval | audit
    max_chars_per_source: 65536
    chunk_chars: 8192
    file_reads:
      enabled: true
      allowlist_paths: []
    network_responses:
      enabled: true
      allowlist_hosts: []
      text_content_types:
        - "text/*"
        - "application/json"
        - "application/*+json"
        - "application/xml"
        - "application/*+xml"
        - "application/javascript"
        - "application/x-www-form-urlencoded"

# ðŸŽ£ ANTI-PHISHING & SANDBOX EVENTS
phishing:
  enabled: true
  suspicious_keywords: ["login", "verify", "update", "bank", "wallet"]
  blocked_tlds: [".xyz", ".top", ".gq", ".zip"] 

# Optional V2 socket-level network guard (default off).
network_failsafe:
  socket_connect: true
  allow_private_network: false
  blocked_hosts: []
  blocked_ips: []
  allowed_ips: []

opa:
  enabled: true
  url: "http://127.0.0.1:8181"
  decision_path: "/v1/data/sentinel/authz/decision"
  timeout_ms: 1500
  fail_mode: "deny"  # deny | allow

  
